 <!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">
    <title>PULS Gel Cena Srbija 2025 | Iskustva ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</title>
    <meta name="description" content="‚úì PULS Gel cena 1500 RSD ‚úì Iskustva kupaca ‚úì Besplatna dostava preko 4000 RSD ‚úì Dostava 24h ‚úì Poruƒçite odmah!">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pulsgel.github.io/PulsGel/">
    <meta property="og:title" content="PULS Gel ‚Äì Prirodni gel za intimnu negu | Srbija 2025">
    <meta property="og:description" content="Prirodni gel koji daje prijatan oseƒáaj topline i punoƒáe. Preko 1.200 zadovoljnih parova. Dostava 24‚Äì48h.">
    <meta property="og:image" content="https://pulsgel.github.io/PulsGel/slika1.webp">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Product",
      "name": "PULS Gel",
      "description": "Prirodni gel za intimnu negu koji daje prijatan oseƒáaj topline i punoƒáe.",
      "url": "https://pulsgel.github.io/PulsGel/",
      "image": "https://pulsgel.github.io/PulsGel/slika1.webp",
      "brand": { "@type": "Brand", "name": "PULS" },
      "offers": {
        "@type": "Offer",
        "priceCurrency": "RSD",
        "price": "1500",
        "itemCondition": "http://schema.org/NewCondition",
        "availability": "http://schema.org/InStock",
        "url": "https://pulsgel.github.io/PulsGel/",
        "priceValidUntil": "2025-12-31"
      }
    }
    </script>

    <style>
        :root { --crvena:#b22222; --svetla:#ff4c4c; --tamna:#111; }
        * { box-sizing:border-box; }
        body { margin:0; background:#000; color:#fff; font-family:Arial,sans-serif; line-height:1.6; }
        h1 { font-size:2.4rem; text-align:center; margin:20px 0; }
        h1 span { color:var(--svetla); }
        h2 { color:var(--svetla); text-align:center; margin:50px 0 25px; }
        .puls-card { background:var(--tamna); border:1px solid #444; padding:20px; border-radius:12px; margin:20px auto; max-width:900px; transition:0.3s; }
        .puls-card:hover { transform:translateY(-5px); box-shadow:0 10px 30px rgba(178,34,34,0.3); }

        .trust-bar { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; background:linear-gradient(135deg,#1a0000,#330000); padding:15px; border-top:2px solid var(--crvena); border-bottom:2px solid var(--crvena); margin:20px 0; }
        .trust-item { text-align:center; font-size:1.1rem; }
        .trust-item span { display:block; color:var(--svetla); font-size:1.5rem; font-weight:bold; }

        .urgency-banner { background:linear-gradient(135deg,var(--crvena),var(--svetla)); color:#fff; text-align:center; padding:14px; font-weight:bold; border-radius:8px; margin:20px auto; max-width:900px; }

        .sticky-cta {
            position:fixed; bottom:20px; right:20px; z-index:1000;
            background:var(--crvena); color:#fff; padding:16px 32px;
            border:none; border-radius:50px; font-size:1.25rem; font-weight:bold;
            cursor:pointer; box-shadow:0 0 30px rgba(178,34,34,0.9);
            animation:pulse 2s infinite; text-transform:uppercase; letter-spacing:1px;
        }
        .sticky-cta:hover { background:#ff4444; transform:scale(1.08); }
        @media (max-width:600px) { .sticky-cta { bottom:15px; right:15px; padding:14px 24px; font-size:1.1rem; } }
        @keyframes pulse { 0%,100% { transform:scale(1); } 50% { transform:scale(1.06); } }
        #countdown { color:#00ff00; font-weight:bold; }

        .info-box { background:#220000; border:2px solid var(--crvena); padding:15px; border-radius:8px; text-align:center; max-width:800px; margin:30px auto; }
    </style>
</head>
<body>

    <h1>PULS Gel <span>1500 RSD</span> ‚Äì Iskustva 2025</h1>
    <p style="text-align:center;font-size:1.3rem;max-width:800px;margin:20px auto;">
        ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è Preko <strong>1.200 zadovoljnih parova</strong> u Srbiji<br>
        üî• Prijatan oseƒáaj topline veƒá za 3‚Äì5 minuta ‚Ä¢ Dostava 24‚Äì48h ‚Ä¢ Diskretno pakovanje
    </p>

    <div class="urgency-banner">
        ‚ö° SAMO DANAS: 50 ml samo 1999 RSD (umesto 2900) ‚Ä¢ Preostalo jo≈° <span style="color:#00ff00;">17</span> komada po akcijskoj ceni!
    </div>

    <div class="trust-bar">
        <div class="trust-item"><span>‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è</span> 1.200+ zadovoljnih kupaca</div>
        <div class="trust-item"><span>Proizvedeno u Srbiji</span> Srbija</div>
        <div class="trust-item"><span>Dostava 24‚Äì48h</span> Brzo i diskretno</div>
        <div class="trust-item"><span>30 dana garancija</span> Povrat novca</div>
    </div>

    <div style="text-align:center;margin:30px 0;">
        <img src="slika1.webp" alt="PULS Gel pakovanja" loading="lazy" style="max-width:100%;height:auto;border-radius:12px;">
    </div>

    <div class="puls-card">
        <h2>Kako PULS Gel deluje?</h2>
        <p>Prirodna formula sa preko 20 biljnih ekstrakata koja daje <strong>prijatan oseƒáaj topline, punoƒáe i opu≈°tenosti</strong> veƒá nekoliko minuta nakon nano≈°enja.</p>
        <ul style="text-align:left;max-width:700px;margin:20px auto;">
            <li>‚úÖ Daje oseƒáaj topline i prijatne stimulacije</li>
            <li>‚úÖ Dugotrajan klizavi efekat</li>
            <li>‚úÖ Potpuno prirodan sastav ‚Äì bezbedan za oralni kontakt</li>
            <li>‚úÖ Idealan za parove i solo trenutke</li>
        </ul>
    </div>

    <h2 style="margin-top:60px;">≈†ta ka≈æu na≈°i kupci?</h2>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:25px;max-width:1100px;margin:40px auto;">
        <div class="puls-card" style="text-align:center;"><p style="font-style:italic;">"Stvarno daje onaj oseƒáaj topline odmah. Supruga i ja smo prezadovoljni."</p><strong>Milan, Beograd</strong> ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <div class="puls-card" style="text-align:center;"><p style="font-style:italic;">"Koristimo ga veƒá mesec dana ‚Äì sve je intenzivnije. Preporuƒçujem!"</p><strong>Jelena i Marko, Ni≈°</strong> ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <div class="puls-card" style="text-align:center;"><p style="font-style:italic;">"Diskretna dostava, efekat odliƒçan. Hvala ekipo!"</p><strong>Aleksandar, Novi Sad</strong> ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
    </div>

    <details style="background:#111;padding:20px;border-radius:12px;margin:40px auto;max-width:800px;border:1px solid #444;cursor:pointer;">
        <summary style="color:#ff4c4c;font-weight:bold;font-size:1.2rem;">Sastav proizvoda (INCI lista)</summary>
        <p style="margin:15px 0;line-height:1.7;color:#ccc;">
            Aqua, Glycerin, Propylene Glycol, Panax Ginseng Root Extract, Paullinia Cupana Seed Extract, Zingiber Officinale Root Extract, Lepidium Meyenii Root Extract, Beta Vulgaris Root Extract, Menthol, Vanillyl Butyl Ether, Cananga Odorata Flower Oil, Xanthan Gum, Sodium Benzoate, Potassium Sorbate, Citric Acid, Parfum.
        </p>
    </details>

    <div class="info-box">
        <p><strong>PULS Gel je kozmetiƒçko sredstvo za spolja≈°nju upotrebu.</strong><br>
        Efekti se razlikuju od osobe do osobe ‚Ä¢ Nije lek ‚Ä¢ Pre prve upotrebe uradite test na maloj povr≈°ini ko≈æe</p>
    </div>

    <h2 id="forma-porudzbine">Porud≈æbina</h2>
        <h2>üîò 15. Porud≈æbina</h2>
        
        <form id="forma-porudzbine">
          
          <div class="info-box">
              <p style="margin: 0; color: #fff;">
                  üöö Porud≈æbine preko <span>4000 RSD</span> ostvaruju **BESPLATNU PO≈†TARINU**.
              </p>
              <p style="margin: 5px 0 0 0; color: #fff;">
                  üéÅ Porud≈æbine preko <span>9000 RSD</span> ostvaruju **DODATNIH 10% POPUSTA**.
              </p>
          </div>

          <label for="ime">Ime *</label>
          <input type="text" name="ime" id="ime" placeholder="Ime" required aria-required="true" />
          
          <label for="prezime">Prezime *</label>
          <input type="text" name="prezime" id="prezime" placeholder="Prezime" required aria-required="true" />
          
          <label for="email">Email *</label>
          <input type="email" name="email" id="email" placeholder="Email" required aria-required="true" />
          
          <label for="telefon">Telefon</label>
          <input type="tel" name="telefon" id="telefon" placeholder="Telefon" aria-label="Telefon" />
          
          <label for="adresa">Adresa za dostavu</label>
          <input type="text" name="adresa" id="adresa" placeholder="Adresa za dostavu" aria-label="Adresa za dostavu" />
          
          <label for="grad">Grad</label>
          <input type="text" name="grad" id="grad" placeholder="Grad" aria-label="Grad" />
          
          <label for="postanski_broj">Po≈°tanski broj</label>
          <input type="text" name="postanski_broj" id="postanski_broj" placeholder="Po≈°tanski broj" aria-label="Po≈°tanski broj" />
          
          <label for="pakovanje">Pakovanje:</label>
          <select name="pakovanje" id="pakovanje" aria-label="Izaberite pakovanje">
            <option value="30 ml" data-cena-rsd="1500" selected>30 ml (1500 RSD)</option>
            <option value="50 ml" data-cena-rsd="2200">50 ml (2200 RSD)</option>
          </select>
          
          <label for="kolicina">Koliƒçina:</label>
          <input type="number" name="kolicina" id="kolicina" value="1" min="1" aria-label="Koliƒçina" />
          
          <label for="iznos_rsd">Iznos Proizvoda (RSD)</label>
          <input type="text" name="iznos_rsd" id="iznos_rsd" placeholder="Iznos Proizvoda (RSD)" readonly aria-label="Iznos proizvoda" value="1500 RSD" />
          
          <label for="dostava">Naƒçin isporuke:</label>
          <select name="dostava" id="dostava" aria-label="Naƒçin isporuke">
            <option value="Liƒçno preuzimanje" data-cena-dostave="0" selected>Liƒçno preuzimanje (0 RSD)</option>
            <option value="Kurirska slu≈æba" data-cena-dostave="400">Kurirska slu≈æba (400 RSD)</option>
          </select>

          <label for="popust_prikaz_polje">Popust (RSD)</label>
          <input type="text" name="popust_prikaz" id="popust_prikaz_polje" placeholder="Popust (RSD)" readonly aria-label="Popust u RSD" value="0 RSD" />
          <p id="popust_prikaz" aria-live="polite"></p> 
          <div id="ukupno_za_placanje" aria-live="polite">Ukupno za plaƒáanje: 1500 RSD</div>
          
          <label for="placanje">Naƒçin plaƒáanja:</label>
          <select name="placanje" id="placanje" aria-label="Naƒçin plaƒáanja">
            <option value="Pouzeƒáem" selected>Pouzeƒáem</option>
            <option value="Raƒçun">Raƒçun</option>
          </select>
          
          <label for="napomena">Napomena za porud≈æbinu</label>
          <textarea name="napomena" id="napomena" placeholder="Napomena" aria-label="Napomena za porud≈æbinu"></textarea>
          
          <button type="submit">Po≈°alji porud≈æbinu</button>
        </form>
    </main>


    <div id="pregledModal" role="dialog" aria-modal="true" aria-labelledby="modal-naslov">
        <div class="modal-sadrzaj">
            <h2 id="modal-naslov">Pregled Porud≈æbine</h2>
            <div id="detaljiIsporuke">
            </div>
            <p style="text-align: center; color: #ff4c4c;">Proverite podatke pre konaƒçne potvrde!</p>

            <button type="button" id="potvrdiPorudzbinu">Potvrdi Porud≈æbinu</button>
            
            <button type="button" id="izmijeniPodatke">Izmeni Podatke</button>
        </div>   
      </div>   
          
    <section style="margin: 60px 0;">
        <h2 style="text-align: center; color: #ff4c4c; margin-bottom: 40px;">üìö Edukativni Blog</h2>
        <p style="text-align: center; color: #ccc; max-width: 600px; margin: 0 auto 30px;">
            Pro≈°irite svoje znanje o intimnom zdravlju kroz na≈°e struƒçno potkrepljene ƒçlanke.
        </p>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">
            
            <div style="background: #111; padding: 25px; border-radius: 10px; border: 1px solid #333;">
                <h3 style="color: #fff; margin-bottom: 15px;">üî¨ Liposomalni Ekstrakti i Vitalnost</h3>
                <p style="color: #ccc; margin-bottom: 20px; line-height: 1.6;">
                    Nauƒçna obja≈°njenja kako liposomalna tehnologija pobolj≈°ava apsorpciju prirodnih sastojaka.
                </p>
                <a href="nauka.html" style="color: #00ff00; text-decoration: none; font-weight: bold;">Proƒçitaj vi≈°e ‚Üí</a>
            </div>
            
            <div style="background: #111; padding: 25px; border-radius: 10px; border: 1px solid #333;">
                <h3 style="color: #fff; margin-bottom: 15px;">üåø Prirodni Sastojci za Intimno Zdravlje</h3>
                <p style="color: #ccc; margin-bottom: 20px; line-height: 1.6;">
                    Kako prirodni sastojci podr≈æavaju intimno zdravlje kroz bezbednu negu.
                </p>
                <a href="blog/prirodni-sastojci.html" style="color: #00ff00; text-decoration: none; font-weight: bold;">Proƒçitaj vi≈°e ‚Üí</a>
            </div>
            
            <div style="background: #111; padding: 25px; border-radius: 10px; border: 1px solid #333;">
                <h3 style="color: #fff; margin-bottom: 15px;">üíß pH Vrednost i Zdravlje Ko≈æe</h3>
                <p style="color: #ccc; margin-bottom: 20px; line-height: 1.6;">
                    Za≈°to je pH 5.0 idealan za negu osetljivih podruƒçja i kako to utiƒçe na efikasnost.
                </p>
                <a href="blog/ph-vrednost.html" style="color: #00ff00; text-decoration: none; font-weight: bold;">Proƒçitaj vi≈°e ‚Üí</a>
            </div>
        </div>
    </section>

    <footer class="main-footer">
        <div class="footer-links">
            <a href="uslovi.html" target="_blank">Uslovi kori≈°ƒáenja</a>
            <a href="privatnost.html" target="_blank">Politika privatnosti</a>
            <a href="reklamacije.html" target="_blank">Reklamacije i Povrat</a>
        </div>
        <section style="margin:70px 0;">
  <h2 style="text-align:center; color:#ff4c4c; margin-bottom:40px;">≈†ta ka≈æu na≈°i kupci?</h2>
  <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:25px; max-width:1100px; margin:0 auto;">
    <div class="puls-card" style="text-align:center;">
      <p style="font-style:italic;">"Stvarno daje onaj oseƒáaj topline odmah. Supruga i ja smo prezadovoljni."</p>
      <strong>Milan, Beograd</strong> <span style="color:#ff4c4c;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
    </div>
    <div class="puls-card" style="text-align:center;">
      <p style="font-style:italic;">"Koristimo ga veƒá mesec dana ‚Äì sve je intenzivnije. Preporuƒçujem!"</p>
      <strong>Jelena i Marko, Ni≈°</strong> <span style="color:#ff4c4c;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
    </div>
    <div class="puls-card" style="text-align:center;">
      <p style="font-style:italic;">"Diskretna dostava, efekat odliƒçan. Hvala ekipo!"</p>
      <strong>Aleksandar, Novi Sad</strong> <span style="color:#ff4c4c;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
    </div>
  </div>
        </section>
        
        <div style="margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 5px;">
            <h4 style="color: #fff; margin-bottom: 10px;">Kontakt informacije:</h4>
            <p style="margin: 5px 0; color: #ccc;">
                üìß <a href="mailto:info@pulsgel.com" style="color: #ccc;">info.pulsgel@gmail.com</a> | 
                üìû <a href="tel:+381614184185" style="color: #ccc;">+381 61 418 4185</a>
            </p>
            <p style="margin: 5px 0; color: #ccc; font-size: 14px;">
                BIO KINETIK D.O.O. ‚Ä¢ MB: 44855749 ‚Ä¢ PIB: 240567039
            </p>
        </div>
        
        <p class="copyright">¬© <span id="currentYear">2025</span> PulsGel Shop. Sva prava zadr≈æana.</p>
    </footer>
<!-- STICKY CTA ‚Äì SKROLA DO FORME -->
<button class="sticky-cta" id="stickyCtaButton">
  <span id="ctaText">PORUƒåI ODMAH ‚Äì AKCIJA TRAJE JO≈† <span id="countdown">11:34</span></span>
</button>

<style>
.sticky-cta {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #b22222;
    color: #fff;
    padding: 16px 30px;
    border: none;
    border-radius: 50px;
    font-size: 1.2rem;
    font-weight: bold;
    cursor: pointer;
    z-index: 1000;
    box-shadow: 0 0 30px rgba(178,34,34,0.9);
    animation: pulse 2s infinite;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    transition: all 0.3s;
}
.sticky-cta:hover { transform: scale(1.08); background:#ff4444; }

@media (max-width: 600px) {
    .sticky-cta { bottom: 15px; right: 15px; padding: 14px 24px; font-size: 1.1rem; }
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.06); }
    100% { transform: scale(1); }
}
#countdown { color: #00ff00; font-weight: bold; }
</style>

<script>
// Random countdown
const vremena = ['11:34','09:12','07:55','14:21','06:08','05:47','12:19','08:41','04:55'];
const randomVreme = vremena[Math.floor(Math.random() * vremena.length)];
document.getElementById('countdown').textContent = randomVreme;

// Skrol do forme
document.getElementById('stickyCtaButton').addEventListener('click', function() {
    const forma = document.getElementById('forma-porudzbine');
    if (forma) {
        forma.scrollIntoView({ 
            behavior: 'smooth',
            block: 'center'   // ovde je fora ‚Äì centriraj formu na ekran
        });
        // bonus: blago trese dugme kad se skroluje
        forma.querySelector('input:first-of-type').focus();
    }
});
</script>

<style>
@keyframes pulse {
  0% { transform:scale(1); }
  50% { transform:scale(1.05); }
  100% { transform:scale(1); }
}
</style>

<script>
// Countdown u sticky dugmetu (menja se svaki put kad se uƒçita stranica)
const vremena = ['11:34', '09:12', '07:55', '14:21', '06:08'];
const randomVreme = vremena[Math.floor(Math.random() * vremena.length)];
document.querySelector('.sticky-cta').innerHTML = `‚ö° PORUƒåI ODMAH ‚Äì AKCIJA TRAJE JO≈† ${randomVreme}`;
</script>
        <script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

<script type="text/javascript">
    // KONFIGURACIJA
    const ADMIN_TEMPLATE_ID = 'template_5o6etkn';
    const KUPAC_TEMPLATE_ID = 'template_u8dh76a';
    const SERVICE_ID = 'service_rxj533m';
    const ADMIN_MAIL = 'info.pulsgel@gmail.com';
    const BREND_NAZIV = 'PulsGel';
    const SENDER_NAME = 'PulsGel Porud≈æbina';

    // KONSTANTE
    const CENA_KURIRSKE_SLUZBE = 400;
    const PRAG_ZA_BESPLATNU_DOSTAVU = 4000;
    const PRAG_ZA_POPUST = 9000;
    const PROCENT_POPUSTA = 0.10;

    // Google Forms fallback
    const GOOGLE_FORM_ACTION_URL = 'https://docs.google.com/forms/d/e/1FAIpQLSdkUOR2rrRO488dGGb1hO7QQkKtQF1ncp68-V8nguex07qi5w/formResponse';
    const GOOGLE_ENTRY_IDS = {
        ime_kupca: 'entry.1018337777',
        prezime_kupca: 'entry.1747761044',
        email_kupca: 'entry.1691350646',
        telefon_kupca: 'entry.144427387',
        adresa_dostave: 'entry.1147048348',
        lista_proizvoda: 'entry.1804246816',
        ukupno: 'entry.173070490',
        nacin_placanja: 'entry.1471328004',
        napomena: 'entry.972352723'
    };

    // Globalne varijable
    let globalFormData = {};
    let lastActiveElement = null;

    // Funkcije za loading state
    function showLoadingState() {
        const dugme = document.getElementById('potvrdiPorudzbinu');
        if (dugme) {
            dugme.innerHTML = '<div class="loading-spinner"></div>≈†aljem...';
            dugme.disabled = true;
        }
    }

    function hideLoadingState() {
        const dugme = document.getElementById('potvrdiPorudzbinu');
        if (dugme) {
            dugme.innerHTML = 'Potvrdi Porud≈æbinu';
            dugme.disabled = false;
        }
    }

    // Google Sheets fallback funkcija
    async function sendToGoogleSheetFallback(data) {
        const params = new URLSearchParams();
        params.append(GOOGLE_ENTRY_IDS.ime_kupca, data.ime_kupca);
        params.append(GOOGLE_ENTRY_IDS.prezime_kupca, data.prezime_kupca);
        params.append(GOOGLE_ENTRY_IDS.email_kupca, data.email_kupca);
        params.append(GOOGLE_ENTRY_IDS.telefon_kupca, data.telefon_kupca);
        params.append(GOOGLE_ENTRY_IDS.adresa_dostave, data.adresa_dostave);
        params.append(GOOGLE_ENTRY_IDS.lista_proizvoda, data.lista_proizvoda);
        params.append(GOOGLE_ENTRY_IDS.ukupno, data.ukupno);
        params.append(GOOGLE_ENTRY_IDS.nacin_placanja, data.nacin_placanja);
        params.append(GOOGLE_ENTRY_IDS.napomena, data.napomena);

        try {
            await fetch(GOOGLE_FORM_ACTION_URL + '?' + params.toString(), {
                method: 'GET',
                mode: 'no-cors'
            });
            console.log("‚úÖ Porud≈æbina saƒçuvana u Google Sheet");
            return { status: 'success', message: 'Saƒçuvano u Sheetu' };
        } catch (error) {
            console.error("‚ùå Gre≈°ka pri slanju u Google Sheet:", error);
            return { status: 'error', message: 'Slanje na Sheet neuspe≈°no' };
        }
    }

    // Glavna funkcija za slanje mailova
    async function sendMail() {
        console.log("üîÑ Pokreƒáem slanje mailova...");
        
        if (typeof emailjs === 'undefined') {
            alert("Gre≈°ka: Sistem za slanje porud≈æbina nije dostupan. Molimo poku≈°ajte kasnije.");
            return;
        }

        if (!globalFormData || !globalFormData.broj_porudzbine) {
            alert("Fatalna gre≈°ka: Podaci o porud≈æbini nisu pronaƒëeni. Molimo poku≈°ajte ponovo.");
            return;
        }

        showLoadingState();

        const finanse = globalFormData.ga4_finanse; 
        
        // GA4 Purchase event
        if (typeof gtag === 'function' && finanse && finanse.ukupnoRSD > 0) {
            gtag('event', 'purchase', {
                transaction_id: globalFormData.broj_porudzbine,
                value: finanse.ukupnoRSD,
                currency: 'RSD',
                items: [{
                    item_id: 'PULS-' + finanse.pakovanje.replace(/\s/g, ''),
                    item_name: 'PULS Gel ' + finanse.pakovanje,
                    price: finanse.cena,
                    quantity: finanse.kolicina
                }]
            });
        }

        // Meta Pixel Purchase event
        if (typeof fbq === 'function' && finanse && finanse.ukupnoRSD > 0) {
            fbq('track', 'Purchase', {
                value: finanse.ukupnoRSD,
                currency: 'RSD',
                content_type: 'product',
                contents: [{
                    id: 'PULS-' + finanse.pakovanje.replace(/\s/g, ''),
                    quantity: finanse.kolicina,
                    item_price: finanse.cena
                }]
            });
        }

        try {
            // Slanje emailova
            console.log("üìß ≈†aljem emailove...");
            const [adminResult, kupacResult] = await Promise.allSettled([
                emailjs.send(SERVICE_ID, ADMIN_TEMPLATE_ID, globalFormData),
                emailjs.send(SERVICE_ID, KUPAC_TEMPLATE_ID, globalFormData)
            ]);

            const adminSuccess = adminResult.status === 'fulfilled';
            const kupacSuccess = kupacResult.status === 'fulfilled';

            console.log("Admin email success:", adminSuccess);
            console.log("Kupac email success:", kupacSuccess);

            if (adminSuccess || kupacSuccess) {
                if (adminSuccess && kupacSuccess) {
                    alert("‚úÖ Porud≈æbina uspe≈°no potvrƒëena! Potvrda je poslata na Va≈° email.");
                } else if (adminSuccess) {
                    alert("‚úÖ Porud≈æbina uspe≈°no potvrƒëena! (Problem sa slanjem potvrde na email)");
                } else {
                    alert("‚úÖ Porud≈æbina uspe≈°no potvrƒëena! (Problem sa obave≈°tenjem prodavca)");
                }
            } else {
                console.warn("‚ùå Oba EmailJS slanja su neuspe≈°na");
                
                // Fallback na Google Sheets
                const fallbackResult = await sendToGoogleSheetFallback(globalFormData);
                if (fallbackResult.status === 'success') {
                    alert("üì¶ Porud≈æbina je primljena, ali imamo problem sa email sistemom. Biƒáete kontaktirani uskoro.");
                } else {
                    alert("‚ùå Do≈°lo je do gre≈°ke. Molimo poku≈°ajte ponovo ili nas kontaktirajte direktno.");
                }
            }
        } catch (error) {
            console.error("‚ùå Gre≈°ka pri slanju:", error);
            alert("‚ùå Do≈°lo je do gre≈°ke pri slanju porud≈æbine. Molimo poku≈°ajte ponovo.");
        } finally {
            hideLoadingState();
            const pregledModal = document.getElementById('pregledModal');
            if (pregledModal) pregledModal.style.display = 'none';
            
            // RESETUJ FORMU NA PODRAZEVANE VREDNOSTI
            const forma = document.getElementById('forma-porudzbine');
            if (forma) {
                forma.reset();
                
                // EKSPLICITNO POSTAVI PODRAZEVANE VREDNOSTI
                const kolicinaEl = document.getElementById('kolicina');
                const pakovanjeEl = document.getElementById('pakovanje');
                const dostavaEl = document.getElementById('dostava');
                const placanjeEl = document.getElementById('placanje');
                
                if (kolicinaEl) kolicinaEl.value = '1';
                if (pakovanjeEl) pakovanjeEl.selectedIndex = 0; // 30ml
                if (dostavaEl) dostavaEl.selectedIndex = 0; // Liƒçno preuzimanje
                if (placanjeEl) placanjeEl.selectedIndex = 0; // Pouzeƒáem
                
                // FORSIRAJ PRORAƒåUN SA NOVIM VREDNOSTIMA
                setTimeout(() => {
                    if (typeof updateIznos === 'function') {
                        updateIznos();
                    }
                }, 100);
            }
            
            if (lastActiveElement) {
                lastActiveElement.focus();
            }
            
            globalFormData = {};
        }
    }

    // Inicijalizacija kada se stranica uƒçita
    document.addEventListener('DOMContentLoaded', function() {
        console.log("üîÑ Inicijalizacija forme...");
        
        // Inicijalizacija EmailJS
        if (typeof emailjs !== 'undefined') {
            emailjs.init("WKV419-gz6OQWSgRJ");
            console.log("‚úÖ EmailJS inicijalizovan");
        } else {
            console.error("‚ùå EmailJS nije dostupan");
        }

        // Postavi trenutnu godinu
        const currentYearEl = document.getElementById('currentYear');
        if (currentYearEl) {
            currentYearEl.textContent = new Date().getFullYear();
        }

        // Dohvati elemente
        const forma = document.getElementById('forma-porudzbine');
        const pakovanjeEl = document.getElementById('pakovanje');
        const kolicinaEl = document.getElementById('kolicina');
        const dostavaEl = document.getElementById('dostava');
        const iznosRsdEl = document.getElementById('iznos_rsd');
        const ukupnoZaPlacanjeEl = document.getElementById('ukupno_za_placanje');
        const popustPrikazPoljeEl = document.getElementById('popust_prikaz_polje');
        const popustPrikazTekstEl = document.getElementById('popust_prikaz');
        const dugmePotvrdi = document.getElementById('potvrdiPorudzbinu');
        const dugmeIzmeni = document.getElementById('izmijeniPodatke');
        const pregledModal = document.getElementById('pregledModal');
        const detaljiIsporuke = document.getElementById('detaljiIsporuke');
        const stickyCtaButton = document.getElementById('stickyCtaButton');

        // Proveri da li svi elementi postoje
        if (!forma) console.error("‚ùå Forma nije pronaƒëena");
        if (!pakovanjeEl) console.error("‚ùå Pakovanje element nije pronaƒëen");
        if (!kolicinaEl) console.error("‚ùå Koliƒçina element nije pronaƒëen");

        // Funkcija za proraƒçun cene
        function updateIznos() {
            if (!pakovanjeEl || !kolicinaEl || !dostavaEl || !iznosRsdEl || !ukupnoZaPlacanjeEl) {
                console.error("‚ùå Nedostaju elementi za proraƒçun");
                return;
            }

            const kolicinaValue = parseInt(kolicinaEl.value);
            const kolicina = (kolicinaValue >= 1 && !isNaN(kolicinaValue)) ? kolicinaValue : 1;
            
            const selectedPakovanje = pakovanjeEl.options[pakovanjeEl.selectedIndex];
            const cenaRsd = parseInt(selectedPakovanje.getAttribute('data-cena-rsd')) || 0;
            
            let medjuzbirRSD = cenaRsd * kolicina;
            let postarinaRSD = 0;
            let popustIznos = 0;
            let popustPoruka = '';
            
            const dostavaTip = dostavaEl.value;
            
            // Proraƒçun po≈°tarine
            if (dostavaTip === 'Kurirska slu≈æba') {
                if (medjuzbirRSD >= PRAG_ZA_BESPLATNU_DOSTAVU) {
                    postarinaRSD = 0;
                    popustPoruka = "‚úÖ Besplatna po≈°tarina!";
                } else {
                    postarinaRSD = CENA_KURIRSKE_SLUZBE;
                }
            }

            // Proraƒçun popusta
            if (medjuzbirRSD >= PRAG_ZA_POPUST) {
                popustIznos = Math.round(medjuzbirRSD * PROCENT_POPUSTA);
                popustPoruka += (popustPoruka ? ' & ' : '') + "üéÅ Popust 10% ukljuƒçen!";
            }

            const ukupnoRSD = medjuzbirRSD + postarinaRSD - popustIznos;

            // A≈æuriranje prikaza
            iznosRsdEl.value = medjuzbirRSD + " RSD";
            
            if (popustPrikazPoljeEl) {
                popustPrikazPoljeEl.value = popustIznos > 0 ? `- ${popustIznos} RSD (10%)` : `0 RSD`;
            }
            
            if (popustPrikazTekstEl) {
                popustPrikazTekstEl.textContent = popustPoruka;
                popustPrikazTekstEl.style.display = popustPoruka ? 'block' : 'none';
            }
            
            if (ukupnoZaPlacanjeEl) {
                ukupnoZaPlacanjeEl.textContent = `Ukupno za plaƒáanje: ${ukupnoRSD} RSD`;
            }

            return {
                medjuzbirRSD,
                postarinaRSD,
                popustIznos,
                ukupnoRSD,
                dostavaTip,
                kolicina,
                pakovanje: selectedPakovanje.value,
                cena: cenaRsd
            };
        }

        // Inicijalni proraƒçun
        updateIznos();

        // Event listeneri za proraƒçun
        if (pakovanjeEl) {
            pakovanjeEl.addEventListener('change', updateIznos);
        }
        if (kolicinaEl) {
            kolicinaEl.addEventListener('input', updateIznos);
        }
        if (dostavaEl) {
            dostavaEl.addEventListener('change', updateIznos);
        }

        // Sticky CTA button
        if (stickyCtaButton && forma) {
            stickyCtaButton.addEventListener('click', function() {
                console.log("Sticky CTA kliknut");
                forma.scrollIntoView({ behavior: 'smooth' });
            });
        }

        // Submit forme
        if (forma) {
            forma.addEventListener('submit', function(e) {
                e.preventDefault();
                console.log("üîÑ Submit forme...");
                
                if (!forma.checkValidity()) {
                    forma.reportValidity();
                    return;
                }

                lastActiveElement = document.activeElement;
                const trenutneFinanse = updateIznos();

                // Meta Pixel Initiate Checkout
                if (typeof fbq === 'function') {
                    fbq('track', 'InitiateCheckout', {
                        value: trenutneFinanse.ukupnoRSD,
                        currency: 'RSD',
                        contents: [{ id: 'PULS', quantity: trenutneFinanse.kolicina }],
                        num_items: trenutneFinanse.kolicina
                    });
                }

                // Priprema podataka za slanje
                globalFormData = {
                    sender_name: SENDER_NAME,
                    admin_email: ADMIN_MAIL,
                    ime_kupca: this.ime.value,
                    prezime_kupca: this.prezime.value,
                    email_kupca: this.email.value,
                    poslati_kupcu: this.email.value,
                    telefon_kupca: this.telefon.value,
                    adresa_dostave: `${this.adresa.value.trim()}, ${this.postanski_broj.value.trim()} ${this.grad.value.trim()}`,
                    medjuzbir: trenutneFinanse.medjuzbirRSD + ' RSD',
                    postarina: trenutneFinanse.postarinaRSD + ' RSD',
                    popust: trenutneFinanse.popustIznos + ' RSD',
                    ukupno: trenutneFinanse.ukupnoRSD + ' RSD',
                    broj_porudzbine: 'PULS-' + Date.now(),
                    nacin_placanja: this.placanje.value,
                    napomena: this.napomena.value || 'Nema napomene',
                    brend_naziv: BREND_NAZIV,
                    dostava: trenutneFinanse.dostavaTip,
                    lista_proizvoda: `PULS Gel ${this.pakovanje.value} x ${this.kolicina.value}`,
                    ga4_finanse: trenutneFinanse
                };

                console.log("üì¶ Podaci za slanje:", globalFormData);

                // Prikaz pregleda u modalu
                if (detaljiIsporuke) {
                    detaljiIsporuke.innerHTML = `
                        <p><strong>Ime i Prezime:</strong> ${globalFormData.ime_kupca} ${globalFormData.prezime_kupca}</p>
                        <p><strong>Email:</strong> ${globalFormData.email_kupca}</p>
                        <p><strong>Telefon:</strong> ${globalFormData.telefon_kupca || 'Nije navedeno'}</p>
                        <hr style="border-color:#444;">
                        <p><strong>Adresa:</strong> ${globalFormData.adresa_dostave}</p>
                        <p><strong>Isporuka:</strong> ${globalFormData.dostava}</p>
                        <p><strong>Plaƒáanje:</strong> ${globalFormData.nacin_placanja}</p>
                        <hr style="border-color:#444;">
                        <p><strong>Proizvod:</strong> PULS Gel ${this.pakovanje.value}</p>
                        <p><strong>Koliƒçina:</strong> ${this.kolicina.value}</p>
                        <p><strong>Iznos Proizvoda:</strong> ${globalFormData.medjuzbir}</p>
                        <p><strong>Po≈°tarina:</strong> ${globalFormData.postarina}</p>
                        <p><strong>Popust (10%):</strong> <span style="color: ${trenutneFinanse.popustIznos > 0 ? '#00ff00' : '#ccc'};">- ${globalFormData.popust}</span></p>
                        <p><strong>Ukupno za Plaƒáanje:</strong> <span style="color: #b22222; font-weight: bold;">${globalFormData.ukupno}</span></p>
                        <hr style="border-color:#444;">
                        <p><strong>Napomena:</strong> ${globalFormData.napomena}</p>
                    `;
                }

                if (pregledModal) {
                    pregledModal.style.display = 'block';
                }

                // ESC key za zatvaranje modala
                function handleEscKey(e) {
                    if (e.key === 'Escape' && pregledModal.style.display === 'block') {
                        pregledModal.style.display = 'none';
                        document.removeEventListener('keydown', handleEscKey);
                    }
                }
                
                document.addEventListener('keydown', handleEscKey);
            });
        }

        // Modal event listeneri
        if (dugmePotvrdi) {
            dugmePotvrdi.addEventListener('click', sendMail);
        }
        
        if (dugmeIzmeni && pregledModal) {
            dugmeIzmeni.addEventListener('click', function() {
                pregledModal.style.display = 'none';
            });
        }

        console.log("‚úÖ Forma inicijalizovana uspe≈°no");
    });

    // Tracking skripte
    let trackingScriptsLoaded = false;
    
    function loadTrackingScripts() {
        if (trackingScriptsLoaded) return;

        // Google Analytics (GA4)
        var gaScript = document.createElement('script');
        gaScript.src = "https://www.googletagmanager.com/gtag/js?id=G-5E43CB4R42";
        gaScript.async = true;
        document.body.appendChild(gaScript);

        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-5E43CB4R42'); 
        
        // Facebook Pixel (Meta)
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '826589170344707');
        fbq('track', 'PageView');
        
        trackingScriptsLoaded = true;
        console.log("‚úÖ Tracking skripte uƒçitane");
    }
    
    function loadTrackingScriptsDelayed() {
        setTimeout(loadTrackingScripts, 2000);
        
        ['scroll', 'mousemove', 'touchstart', 'click'].forEach(event => {
            document.addEventListener(event, loadTrackingScripts, { once: true });
        });
    }

    // Pokreni tracking
    loadTrackingScriptsDelayed();
</script>
</body>
</html>
